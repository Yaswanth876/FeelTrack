<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FeelTrack - Emotion Detection</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <h2 class="text-center mb-4">üé≠ FeelTrack Emotion Detector</h2>
        <textarea id="textToAnalyze" class="form-control" rows="4" placeholder="Enter text here..."></textarea>
        <button class="btn btn-primary mt-3" onclick="RunSentimentAnalysis()">Analyze</button>
        <div id="system_response" class="mt-4"></div>
    </div>

    <script>
        // üëá Paste your JavaScript here
        let RunSentimentAnalysis = () => {
            const textToAnalyze = document.getElementById("textToAnalyze").value.trim();

            if (!textToAnalyze) {
                document.getElementById("system_response").innerHTML =
                    "<div class='alert alert-warning'>‚ö†Ô∏è Please enter some text to analyze.</div>";
                return;
            }

            const xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState === 4) {
                    if (this.status === 200) {
                        try {
                            const result = JSON.parse(xhttp.responseText);

                            const emotionScores = result.emotion_scores || {};
                            let emotionsList = "";

                            for (const [emotion, score] of Object.entries(emotionScores)) {
                                emotionsList += `<li>${emotion.charAt(0).toUpperCase() + emotion.slice(1)}: ${score.toFixed(3)}</li>`;
                            }

                            const responseHTML = `
                                <div class="card mt-4 p-3">
                                    <h4><strong>Dominant Emotion:</strong> ${result.dominant_emotion?.toUpperCase()}</h4>
                                    <ul>${emotionsList}</ul>
                                </div>`;
                            
                            document.getElementById("system_response").innerHTML = responseHTML;
                        } catch (err) {
                            document.getElementById("system_response").innerHTML =
                                "<div class='alert alert-danger'>‚ùå Invalid response format from server.</div>";
                        }
                    } else {
                        document.getElementById("system_response").innerHTML =
                            "<div class='alert alert-danger'>‚ùå Error: Unable to get response from the server.</div>";
                    }
                }
            };

            xhttp.open("GET", `/emotionDetector?textToAnalyze=${encodeURIComponent(textToAnalyze)}`, true);
            xhttp.send();
        };
    </script>
</body>
</html>
